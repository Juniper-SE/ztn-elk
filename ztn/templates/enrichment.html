<html>

<head>
    <title>Junos SD Enrichment Form</title>
    <script src="/js/enrichment.js"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
        integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
</head>

<body>
    This page allows you to make changes to the fields automatically pulled from logs.
    <hr />

    <input type="checkbox" id="recommended" value="recommended" onchange="useRecommended()">
    <label for="recommended">Use recommended values?</label>

    <form>
        <label for="sourceaddr">Source address</label>
        <select id="sourceaddr" onchange="onChangeSrcAddr()">
            <option value='{{ srcaddr }}'>{{srcaddr}}</option>
            <option id="src_subnet" value='{{ srcsubnet }}'>{{srcsubnet}}</option>
            <input type="text" placeholder="CIDR" style="width:50px" id="src_cidr" disabled>
        </select>

        <label for="sourceport">Source port</label>
        <select id="sourceport" onchange="onChangeSrcPort()">
            <option value='{{ srcport }}'>{{srcport}}</option>
            <option id="srcport_any" value='any'>any</option>
        </select>

        <label for="sourceaddr">Destination address</label>
        <select id="destaddr" onchange="onChangeDestAddr()">
            <option value='{{ destaddr }}'>{{destaddr}}</option>
            <option id="dest_subnet" value='{{ destsubnet }}'>{{srcsubnet}}</option>
            <input type="text" placeholder="CIDR" style="width:50px" id="src_cidr" disabled>
        </select>

        <label for="destport">Destination port</label>
        <select id="destport" onchange="onChangeDestPort()">
            <option value='{{ destport }}'>{{destport}}</option>
            <option id="destport_any" value='any'>any</option>
        </select>


    </form>
    {% if srcaddr %}
    <table style="width:300px">
        <tr>
            <th>Field</th>
            <th>Value</th>
        </tr>
        <tr>
            <td>Source Address</td>
            <td>{{ srcaddr }}</td>
        </tr>
        <tr>
            <td>Source Port</td>
            <td>{{ srcport }}</td>
        </tr>
        <tr>
            <td>Destination Address</td>
            <td>{{ destaddr }}</td>
        </tr>
        <tr>
            <td>Destination Port</td>
            <td>{{ destport }}</td>
        </tr>
        <tr>
            <td>Service name</td>
            <td>{{ servicename }}</td>
        </tr>
        <tr>
            <td>Application</td>
            <td>{{ application }}</td>
        </tr>
        <tr>
            <td>Username</td>
            <td>{{ username }}</td>
        </tr>
        <tr>
            <td>Source zone</td>
            <td>{{ srczone }}</td>
        </tr>
        <tr>
            <td>Destination zone</td>
            <td>{{ destzone }}</td>
        </tr>
    </table>
    <form method="post" action="/enrichment?{{ qs }}">
        <button>Display enrichments</button>
    </form>
    {% endif %}

    The naming policy for all objects follow the format: 'ZTN_ELK_[object_name]_[random_id]'. For example, a new address
    object created might have the name 'ZTN_ELK_ADDR_12345'.

    <form method="post" action="/?{{ qs }}">
        <button type="submit">Confirm</button>
    </form>
</body>

</html>