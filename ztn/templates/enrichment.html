<html>

<head>
    <title>Junos SD Enrichment Form</title>
    <script src="/js/enrichment.js"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
        integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
</head>

<body style="margin:4px;padding:4px">
    This page allows you to make changes to the fields automatically pulled from logs.
    <hr />

    <input type="checkbox" id="recommended" value="recommended" onchange="useRecommended()">
    <label for="recommended">Use recommended values?</label>

    <form method="post" action="/enrichment/submit">
        <table style="width:500px">
            <tr>
                <td>
                    <label for="sourceaddr">Source address</label>
                </td>
                <td>
                    <select id="sourceaddr" name="sourceaddr" onchange="onChangeSrcAddr()">
                        <option value='{{ srcaddr }}'>{{srcaddr}}</option>
                        <option name="src_subnet" id="src_subnet" value='{{ srcsubnet }}'>{{srcsubnet}}</option>
                        <input type="number" placeholder="CIDR" style="width:50px" name="src_cidr" id="src_cidr"
                            disabled min="8" max="32">
                    </select>
                </td>
            </tr>
            <tr>
                <td>
                    <label for="sourceport">Source port</label>
                </td>
                <td>
                    <select name="sourceport" id="sourceport" onchange="onChangeSrcPort()">
                        <option value='{{ srcport }}'>{{srcport}}</option>
                        <option name="srcport_any" value='any'>any</option>
                    </select>
                </td>
            </tr>
            <tr>
                <td>
                    <label for="destaddr">Destination address</label>
                </td>
                <td>
                    <select id="destaddr" name="destaddr" onchange="onChangeDestAddr()">
                        <option value='{{ destaddr }}'>{{destaddr}}</option>
                        <option name="dest_subnet" id="dest_subnet" value='{{ destsubnet }}'>{{destsubnet}}</option>
                        <input type="number" placeholder="CIDR" style="width:50px" name="dest_cidr" id="dest_cidr"
                            disabled min="8" max="32">
                    </select>
                </td>
            </tr>
            <tr>
                <td>
                    <label for="destport">Destination port</label>
                </td>
                <td>
                    <select name="destport" id="destport" onchange="onChangeDestPort()">
                        <option value='{{ destport }}'>{{destport}}</option>
                        <option name="destport_any" value='any'>any</option>
                    </select>
                </td>
            </tr>

            <tr>
                <td>
                    <label for="srczone">Source zone</label>
                </td>
                <td>
                    <select name="srczone" id="srczone" onchange="onChangeSrcZone()">
                        <option value='{{ srczone }}'>{{srczone}}</option>
                        <option name="srczone_any" value='any'>any</option>
                        <option name="srczone_trust" value='trust'>trust</option>
                        <option name="srczone_untrust" value='untrust'>untrust</option>
                    </select>
                </td>
            </tr>

            <tr>
                <td>
                    <label for="destzone">Destination zone</label>
                </td>
                <td>
                    <select name="destzone" id="destzone" onchange="onChangeDestZone()">
                        <option value='{{ destzone }}'>{{destzone}}</option>
                        <option name="destzone_any" value='any'>any</option>
                        <option name="srczone_trust" value='trust'>trust</option>
                        <option name="srczone_untrust" value='untrust'>untrust</option>
                    </select>
                </td>
            </tr>
            <tr>
                <td>
                    <label for="username">Username</label>
                </td>
                <td>
                    <select name="username" id="username" onchange="onChangeUsername()">
                        <option value='{{ username }}'>{{username}}</option>
                        <option name="username_group" value='group'>group</option>
                    </select>
                </td>
            </tr>
            <tr>
                <td>
                    <label for="servicename">Service Name</label>
                </td>
                <td>
                    <select name="servicename" id="servicename" onchange="onChangeApplication()">
                        <option value='{{ servicename }}'>{{servicename}}</option>
                        <option name="servicename_any" value='any'>any</option>
                    </select>
                </td>
            </tr>
            <tr>
                <td>
                    <label for="application">Application</label>
                </td>
                <td>
                    <select name="application" id="application" onchange="onChangeApplication()">
                        <option value='{{ application }}'>{{application}}</option>
                        <option name="application_any" value='any'>any</option>
                    </select>
                </td>
            </tr>
            <tr>
                <td>
                    <label for="policy_name">Policy Name</label>
                </td>
                <td>
                    <input name="policy_name" name="policy_name" type="text" placeholder="ZTN_ELK_POLICY_12345">
                </td>
            </tr>
            <tr>
                <td>
                    <label for="rule_name">Rule Name</label>
                </td>
                <td>
                    <input name="rule_name" id="rule_name" type="text" placeholder="ZTN_ELK_RULE_12345">
                </td>
            </tr>
        </table>
        <input type="hidden" id="protocol_id" name="protocol_id" value="{{ protocol_id }}">
        <button type="submit">Submit enriched form</button>
    </form>

</body>

</html>