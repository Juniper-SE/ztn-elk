<html>

<head>
    <title>Junos SD Enrichment Form</title>
    <script>
        function onChangeSrcAddr() {
            var selectBox = document.getElementById("sourceaddr")
            var selectedValue = selectBox.options[selectBox.selectedIndex].value;

            if (selectBox.options[selectBox.selectedIndex].id == "src_subnet") {
                document.getElementById("src_cidr").disabled = false;
            } else {
                document.getElementById("src_cidr").disabled = true;
                document.getElementById("src_cidr").value = "";
            }
            alert(selectedValue);
        }
    </script>
</head>

<body>
    Please confirm the security policy and rule that will be sent to Junos Space Security Director.
    <hr />

    <form>
        <label for="sourceaddr">Choose address or subnet:</label>
        <select id="sourceaddr">
            <option value='{{ srcaddr }}'>{{srcaddr}}</option>
            <option id="src_subnet" value='{{ srcsubnet }}'>{{srcsubnet}}</option>
            / <input type="text" placeholder="CIDR" style="width:40px" id="src_cidr">
        </select>
    </form>
    {% if srcaddr %}
    <table style="width:300px">
        <tr>
            <th>Field</th>
            <th>Value</th>
        </tr>
        <tr>
            <td>Source Address</td>
            <td>{{ srcaddr }}</td>
        </tr>
        <tr>
            <td>Source Port</td>
            <td>{{ srcport }}</td>
        </tr>
        <tr>
            <td>Destination Address</td>
            <td>{{ destaddr }}</td>
        </tr>
        <tr>
            <td>Destination Port</td>
            <td>{{ destport }}</td>
        </tr>
        <tr>
            <td>Service name</td>
            <td>{{ servicename }}</td>
        </tr>
        <tr>
            <td>Application</td>
            <td>{{ application }}</td>
        </tr>
        <tr>
            <td>Username</td>
            <td>{{ username }}</td>
        </tr>
        <tr>
            <td>Source zone</td>
            <td>{{ srczone }}</td>
        </tr>
        <tr>
            <td>Destination zone</td>
            <td>{{ destzone }}</td>
        </tr>
    </table>
    <form method="post" action="/enrichment?{{ qs }}">
        <button>Display enrichments</button>
    </form>
    {% endif %}

    The naming policy for all objects follow the format: 'ZTN_ELK_[object_name]_[random_id]'. For example, a new address
    object created might have the name 'ZTN_ELK_ADDR_12345'.

    <form method="post" action="/?{{ qs }}">
        <button type="submit">Confirm</button>
    </form>
</body>

</html>